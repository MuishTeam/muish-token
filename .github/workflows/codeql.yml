name: "Code Security"

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  schedule:
    - cron: '38 9 * * 6'  # Weekly scan on Saturdays

jobs:
  # Optional CodeQL scan (e.g., if JS tooling/scripts are present)
  # Uncomment if needed
  # codeql:
  #   name: CodeQL Analysis
  #   runs-on: ubuntu-latest
  #   permissions:
  #     security-events: write
  #     actions: read
  #     contents: read
  #   strategy:
  #     fail-fast: false
  #     matrix:
  #       language: [ javascript-typescript ]
  #       build-mode: [ none ]
  #   steps:
  #     - name: Checkout repository
  #       uses: actions/checkout@v4
  #
  #     - name: Initialize CodeQL
  #       uses: github/codeql-action/init@v3
  #       with:
  #         languages: ${{ matrix.language }}
  #         build-mode: ${{ matrix.build-mode }}
  #
  #     - name: Perform CodeQL Analysis
  #       uses: github/codeql-action/analyze@v3
  #       with:
  #         category: "/language:${{ matrix.language }}"

  slither:
    name: Slither Solidity Analysis
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install Slither
        run: |
          sudo apt-get update && sudo apt-get install -y python3-pip
          pip3 install slither-analyzer

      - name: Run Slither
        run: |
          slither . --fail-high --exclude solc-version
